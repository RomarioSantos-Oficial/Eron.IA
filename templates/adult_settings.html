{% extends "base.html" %}

{% block title %}Configurações Adultas - Eron{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card border-danger">
                <div class="card-header bg-danger text-white">
                    <h3 class="card-title mb-0">
                        🔞 Configurações do Modo Adulto
                    </h3>
                </div>
                <div class="card-body">
                    <!-- Status atual -->
                    <div class="alert alert-info">
                        <h5>📋 Status Atual:</h5>
                        <div class="row">
                            <div class="col-md-3">
                                <strong>Intensidade:</strong><br>
                                <span class="badge bg-primary fs-6">{{ adult_prefs.intensity_level if adult_prefs else 1 }}/5</span>
                            </div>
                            <div class="col-md-3">
                                <strong>Estilo:</strong><br>
                                <span class="badge bg-secondary fs-6">
                                    {% if adult_prefs %}
                                        {% if adult_prefs.interaction_style == 'romantic' %}💕 Romântico
                                        {% elif adult_prefs.interaction_style == 'playful' %}😄 Brincalhão
                                        {% elif adult_prefs.interaction_style == 'seductive' %}😏 Sedutor
                                        {% elif adult_prefs.interaction_style == 'intimate' %}💖 Íntimo
                                        {% elif adult_prefs.interaction_style == 'passionate' %}🔥 Apaixonado
                                        {% else %}{{ adult_prefs.interaction_style }}
                                        {% endif %}
                                    {% else %}💕 Romântico
                                    {% endif %}
                                </span>
                            </div>
                            <div class="col-md-3">
                                <strong>Preferências:</strong><br>
                                <span class="badge bg-success fs-6">
                                    {{ adult_prefs.content_preferences|length if adult_prefs and adult_prefs.content_preferences else 0 }}
                                </span>
                            </div>
                            <div class="col-md-3">
                                <strong>Limites:</strong><br>
                                <span class="badge bg-warning fs-6">
                                    {{ adult_prefs.boundaries|length if adult_prefs and adult_prefs.boundaries else 0 }}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Formulário de configurações -->
                    <form method="post">
                        <!-- Nível de Intensidade -->
                        <div class="mb-4">
                            <label class="form-label h5">⚡ Nível de Intensidade</label>
                            <div class="row">
                                {% for level in range(1, 6) %}
                                <div class="col-md mb-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="intensity" 
                                               id="intensity{{ level }}" value="{{ level }}"
                                               {% if (adult_prefs and adult_prefs.intensity_level == level) or (not adult_prefs and level == 1) %}checked{% endif %}>
                                        <label class="form-check-label" for="intensity{{ level }}">
                                            <div class="card border-{% if level <= 2 %}success{% elif level <= 3 %}warning{% else %}danger{% endif %} h-100">
                                                <div class="card-body text-center p-2">
                                                    <div class="fw-bold">{{ level }}/5</div>
                                                    <div class="small">
                                                        {% if level == 1 %}🟢 Suave
                                                        {% elif level == 2 %}🟡 Moderado
                                                        {% elif level == 3 %}🟠 Médio
                                                        {% elif level == 4 %}🔴 Intenso
                                                        {% elif level == 5 %}🟣 Máximo
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                            
                            <!-- Descrições dos níveis -->
                            <div class="mt-2">
                                <div id="intensity-desc">
                                    <div class="alert alert-light">
                                        <strong id="intensity-title">🟢 Nível 1 - Suave</strong>
                                        <p id="intensity-description" class="mb-0">Romance leve e sutil, conversas carinhosas com linguagem delicada.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Estilo de Interação -->
                        <div class="mb-4">
                            <label class="form-label h5">💫 Estilo de Interação</label>
                            <div class="row">
                                {% set styles = [
                                    ('romantic', '💕', 'Romântico', 'Carinhoso e doce, focado em sentimentos'),
                                    ('playful', '😄', 'Brincalhão', 'Divertido e descontraído, com humor'),
                                    ('seductive', '😏', 'Sedutor', 'Charmoso e envolvente, mais provocativo'),
                                    ('intimate', '💖', 'Íntimo', 'Próximo e pessoal, conexão profunda'),
                                    ('passionate', '🔥', 'Apaixonado', 'Intenso e ardente, muito expressivo')
                                ] %}
                                
                                {% for style_value, emoji, style_name, description in styles %}
                                <div class="col-md-6 mb-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="style" 
                                               id="style{{ style_value }}" value="{{ style_value }}"
                                               {% if (adult_prefs and adult_prefs.interaction_style == style_value) or (not adult_prefs and style_value == 'romantic') %}checked{% endif %}>
                                        <label class="form-check-label w-100" for="style{{ style_value }}">
                                            <div class="card border-secondary h-100">
                                                <div class="card-body p-2">
                                                    <div class="fw-bold">{{ emoji }} {{ style_name }}</div>
                                                    <div class="small text-muted">{{ description }}</div>
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- Preferências de Conteúdo -->
                        <div class="mb-4">
                            <label class="form-label h5">🎯 Preferências de Conteúdo</label>
                            <div class="row">
                                {% set content_prefs = [
                                    ('romantic_talks', '💕 Conversas românticas'),
                                    ('intimate_discussions', '💖 Discussões íntimas'),
                                    ('playful_banter', '😄 Conversas brincalhonas'),
                                    ('emotional_support', '🤗 Suporte emocional'),
                                    ('fantasy_roleplay', '🎭 Roleplay e fantasia'),
                                    ('deep_connection', '🔗 Conexão profunda'),
                                    ('flirtatious_chat', '😉 Conversas sedutoras'),
                                    ('passionate_expression', '🔥 Expressões apaixonadas')
                                ] %}
                                
                                {% for pref_value, pref_name in content_prefs %}
                                <div class="col-md-6 mb-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="preferences" 
                                               value="{{ pref_value }}" id="pref{{ pref_value }}"
                                               {% if adult_prefs and pref_value in adult_prefs.content_preferences %}checked{% endif %}>
                                        <label class="form-check-label" for="pref{{ pref_value }}">
                                            {{ pref_name }}
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- Limites Pessoais -->
                        <div class="mb-4">
                            <label class="form-label h5">🚧 Limites Pessoais</label>
                            <div class="alert alert-warning">
                                <small>⚠️ Marque os tipos de conteúdo que você NÃO deseja receber:</small>
                            </div>
                            <div class="row">
                                {% set boundaries = [
                                    ('no_explicit_language', '🚫 Linguagem muito explícita'),
                                    ('no_graphic_content', '🚫 Conteúdo muito gráfico'),
                                    ('no_aggressive_tone', '🚫 Tom agressivo'),
                                    ('no_vulgar_expressions', '🚫 Expressões vulgares'),
                                    ('keep_respectful', '✅ Manter sempre respeitoso'),
                                    ('emotional_boundaries', '🛡️ Respeitar limites emocionais'),
                                    ('no_pressure', '🚫 Sem pressão ou insistência'),
                                    ('consent_focused', '✅ Focado no consentimento')
                                ] %}
                                
                                {% for boundary_value, boundary_name in boundaries %}
                                <div class="col-md-6 mb-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="boundaries" 
                                               value="{{ boundary_value }}" id="bound{{ boundary_value }}"
                                               {% if adult_prefs and boundary_value in adult_prefs.boundaries %}checked{% endif %}>
                                        <label class="form-check-label" for="bound{{ boundary_value }}">
                                            {{ boundary_name }}
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- Botões de Ação -->
                        <div class="row">
                            <div class="col-md-4">
                                <button type="submit" class="btn btn-danger btn-lg w-100">
                                    💾 Salvar Configurações
                                </button>
                            </div>
                            <div class="col-md-4">
                                <a href="{{ url_for('personalize') }}" class="btn btn-secondary btn-lg w-100">
                                    🔙 Voltar
                                </a>
                            </div>
                            <div class="col-md-4">
                                <a href="{{ url_for('chat') }}" class="btn btn-success btn-lg w-100">
                                    💬 Ir para o Chat
                                </a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Atualizar descrição do nível de intensidade
const intensityRadios = document.querySelectorAll('input[name="intensity"]');
const intensityTitle = document.getElementById('intensity-title');
const intensityDescription = document.getElementById('intensity-description');

const intensityDescriptions = {
    1: {
        title: '🟢 Nível 1 - Suave',
        description: 'Romance leve e sutil, conversas carinhosas com linguagem delicada e respeitosa.'
    },
    2: {
        title: '🟡 Nível 2 - Moderado', 
        description: 'Romance mais intenso, demonstrações de afeto mais claras e conversas mais profundas.'
    },
    3: {
        title: '🟠 Nível 3 - Médio',
        description: 'Sensualidade presente, linguagem mais ousada e interações mais íntimas.'
    },
    4: {
        title: '🔴 Nível 4 - Intenso',
        description: 'Paixão evidente, expressões ardentes e conversas muito íntimas e pessoais.'
    },
    5: {
        title: '🟣 Nível 5 - Máximo',
        description: 'Máxima intimidade, linguagem apaixonada e interações muito próximas e intensas.'
    }
};

intensityRadios.forEach(radio => {
    radio.addEventListener('change', function() {
        const level = parseInt(this.value);
        const info = intensityDescriptions[level];
        intensityTitle.textContent = info.title;
        intensityDescription.textContent = info.description;
    });
});

// Definir descrição inicial baseada no valor selecionado
document.addEventListener('DOMContentLoaded', function() {
    const selectedIntensity = document.querySelector('input[name="intensity"]:checked');
    if (selectedIntensity) {
        const level = parseInt(selectedIntensity.value);
        const info = intensityDescriptions[level];
        intensityTitle.textContent = info.title;
        intensityDescription.textContent = info.description;
    }
});
</script>
{% endblock %}